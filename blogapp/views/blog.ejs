<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('partials/head') %>
        <title> Blog</title>
</head>

<body>
    <%- include('partials/nav') %>
        <div class="container">
            <h1>
                <%=blog.title%>
            </h1>

             <div class="container d-flex align-items-center ">
                <img src="<%=blog.coverImageURL%>" class="card-img-top rounded-3 "
                    style="height:20rem;width:20rem;object-fit:cover;" />

                <% if (user && blog.createdBy._id.toString()===user._id.toString()) { %>
            <form method="POST" action="/blog/<%= blog._id %>?_method=DELETE" class="ms-auto">
                <label>Delete this post</label>
                <button class="btn btn-danger">Delete</button>
            </form>
            <% } %>
             </div>
                
                    <pre class="mt-3"><%=blog.body%></pre>
                <div class="author ms-auto"><img src="<%=blog.createdBy.profilePic%> " width="100px">
                    <div>
                        <h5 class="mb-0">
                            <%= blog.createdBy.fullName %>
                        </h5>
                        <small class="text-muted">Author</small>
                    </div>
                </div>

                <div class="constainer mt-3">
                    <h3>Comments(<%=comments.length%>)</h3>
                    <form action="/blog/comment/<%= blog._id %>" method="POST">
                        <div class="  mb-3">
                            <input type="text" class="form-control" name="content"  >
                        </div>

                        <button type="submit" class="btn btn-primary">Add</button>
                    </form>
                </div>
                <div class="list-group mt-3">
        <% if (comments.length === 0) { %>
            <p class="text-muted">No comments yet. Be the first to comment!</p>
        <% } %>

        <% comments.forEach(comment => { %>
            <div class="list-group-item mb-2 rounded shadow-sm">
                <div class="d-flex align-items-center mb-1">
                    <img src="<%= comment.createdBy.profilePic %>" class="rounded-circle me-2" width="40" height="40" alt="author pic">
                    <div>
                        <strong><%= comment.createdBy.fullName %></strong><br>
                        <small class="text-muted"><%= new Date(comment.createdAt).toLocaleString() %></small>
                    </div>
                </div>
                <p class="mb-0 ps-5"><%= comment.content %></p>
            </div>
        <% }) %>
    </div>


            
            
        </div>

        


                <%- include('partials/script') %>
</body>

</html>